<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cronômetro</title>
    <script src="https://cdn.tailwindcss.com"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&display=swap" rel="stylesheet" />

    <style>
        :root {
            color-scheme: dark;
        }

        html,
        body {
            height: 100%;
        }

        body {
            margin: 0;
            background: #000;
            user-select: none;
            -webkit-user-select: none;
            -webkit-touch-callout: none;
        }

        .font-orbitron {
            font-family: 'Orbitron', sans-serif;
        }

        /* Fundo com DIVs (sem <img>) */
        #backgroundSlider {
            position: fixed;
            inset: 0;
            z-index: 1;
            overflow: hidden;
            box-shadow: inset 0 0 150px rgba(0, 0, 0, .5);
        }

        .bg-slide {
            position: absolute;
            inset: 0;
            opacity: 0;
            transition: opacity 2s ease-in-out;
            background-size: cover;
            background-position: center center;
            filter: blur(12px) brightness(.8);
            transform: scale(1.1);
            pointer-events: none;
            /* não clicável */
        }

        .bg-slide.active {
            opacity: 1;
        }

        /* Barra circular */
        .progress-circle {
            position: relative;
            width: 500px;
            height: 500px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .progress-circle svg {
            position: absolute;
            inset: 0;
            width: 100%;
            height: 100%;
        }

        .progress-circle circle {
            fill: none;
            stroke-width: 20;
            transform-origin: 50% 50%;
            transform: rotate(-90deg);
        }

        .bg-circle {
            stroke: rgba(255, 255, 255, .15);
        }

        .fg-circle {
            stroke: #fff;
            transition: stroke-dashoffset .3s linear, stroke .5s ease;
        }

        /* Tela preta final */
        #blackoutOverlay {
            z-index: 50;
            transition: opacity 1.5s ease-in-out;
        }

        /* Botão iniciar */
        #startButton {
            z-index: 10;
            background: rgba(255, 255, 255, .1);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            border: 2px solid rgba(255, 255, 255, .3);
            transition: all .3s ease;
            -webkit-user-drag: none;
        }

        #startButton:hover {
            background: rgba(255, 255, 255, .2);
            transform: scale(1.05);
        }

        /* Impedir drag de tudo */
        * {
            -webkit-user-drag: none;
        }
    </style>
</head>

<body class="flex items-center justify-center min-h-screen relative overflow-hidden" oncontextmenu="return false">
    <!-- bloqueia clique direito -->

    <div id="backgroundSlider" aria-hidden="true"></div>

    <div id="blackoutOverlay" class="fixed top-0 left-0 w-full h-full bg-black hidden opacity-0"></div>

    <div id="startContainer" class="relative z-10 select-none">
        <button id="startButton"
            class="w-48 h-48 rounded-full flex items-center justify-center text-white shadow-2xl active:scale-95">
            <svg class="w-28 h-28" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24"
                aria-hidden="true">
                <path fill-rule="evenodd"
                    d="M4.5 5.653c0-1.426 1.529-2.33 2.779-1.643l11.54 6.348c1.295.712 1.295 2.573 0 3.285L7.28 19.99c-1.25.687-2.779-.217-2.779-1.643V5.653z"
                    clip-rule="evenodd" />
            </svg>
            <span class="sr-only">Iniciar cronômetro</span>
        </button>
    </div>

    <div id="timerContainer" class="hidden relative z-10 select-none" aria-live="polite">
        <div class="progress-circle">
            <svg role="img" aria-label="Progresso do tempo">
                <circle class="bg-circle" cx="50%" cy="50%" r="230"></circle>
                <circle id="fgCircle" class="fg-circle" cx="50%" cy="50%" r="230"></circle>
            </svg>
            <div id="timer" class="absolute font-orbitron text-[7rem] font-bold text-white">05:00</div>
        </div>
    </div>

    <script>
        const initialMinutes = 5;
        let timeInSeconds = initialMinutes * 60;
        let countdownInterval, isRunning = false;

        const backgroundSlider = document.getElementById('backgroundSlider');
        const blackoutOverlay = document.getElementById('blackoutOverlay');
        const startContainer = document.getElementById('startContainer');
        const startButton = document.getElementById('startButton');
        const timerContainer = document.getElementById('timerContainer');
        const timerDisplay = document.getElementById('timer');
        const fgCircle = document.getElementById('fgCircle');

        // círculo
        const radius = fgCircle.r.baseVal.value;
        const circumference = 2 * Math.PI * radius;
        fgCircle.style.strokeDasharray = `${circumference} ${circumference}`;
        fgCircle.style.strokeDashoffset = circumference;

        // imagens agora como background em DIV (sem <img>)
        const backgroundImages = [
            'https://cms-imgp.jw-cdn.org/img/p/2022681/univ/art/2022681_univ_cnt_2_lg.jpg',
            'https://cms-imgp.jw-cdn.org/img/p/2022681/univ/art/2022681_univ_cnt_4_xl.jpg',
            'https://cms-imgp.jw-cdn.org/img/p/1102025973/univ/art/1102025973_univ_cnt_1_xl.jpg',
            'https://cms-imgp.jw-cdn.org/img/p/1102025973/univ/art/1102025973_univ_cnt_7_xl.jpg'
        ];
        let currentImageIndex = 0;

        function loadBackgroundImages() {
            backgroundImages.forEach((src, index) => {
                const slide = document.createElement('div');
                slide.className = 'bg-slide' + (index === 0 ? ' active' : '');
                slide.style.backgroundImage = `url('${src}')`;
                backgroundSlider.appendChild(slide);
            });

            setInterval(() => {
                const slides = backgroundSlider.children;
                if (!slides.length) return;
                slides[currentImageIndex]?.classList.remove('active');
                currentImageIndex = (currentImageIndex + 1) % slides.length;
                slides[currentImageIndex]?.classList.add('active');
            }, 8000);
        }

        function setProgress(percent) {
            const offset = circumference - (percent / 100) * circumference;
            fgCircle.style.strokeDashoffset = offset;
        }

        function updateDisplay() {
            const m = Math.floor(timeInSeconds / 60);
            const s = timeInSeconds % 60;
            timerDisplay.textContent = `${String(m).padStart(2, '0')}:${String(s).padStart(2, '0')}`;

            const total = initialMinutes * 60;
            setProgress((timeInSeconds / total) * 100);

            fgCircle.classList.remove('stroke-white', 'stroke-yellow-300', 'stroke-red-500');
            if (timeInSeconds <= 10) fgCircle.classList.add('stroke-red-500');
            else if (timeInSeconds <= 60) fgCircle.classList.add('stroke-yellow-300');
            else fgCircle.classList.add('stroke-white');
        }

        function startTimer() {
            if (isRunning) return;
            document.documentElement.requestFullscreen().catch(() => { });
            startContainer.classList.add('hidden');
            timerContainer.classList.remove('hidden');
            isRunning = true;
            countdownInterval = setInterval(() => {
                timeInSeconds--; updateDisplay();
                if (timeInSeconds <= 0) {
                    clearInterval(countdownInterval); isRunning = false; showBlackout();
                }
            }, 1000);
        }

        function showBlackout() {
            timerContainer.classList.add('hidden');
            blackoutOverlay.classList.remove('hidden');
            requestAnimationFrame(() => blackoutOverlay.classList.remove('opacity-0'));
        }

        function resetApp() {
            clearInterval(countdownInterval);
            isRunning = false;
            timeInSeconds = initialMinutes * 60;
            updateDisplay();
            blackoutOverlay.classList.add('hidden', 'opacity-0');
            timerContainer.classList.add('hidden');
            startContainer.classList.remove('hidden');
        }

        // Eventos
        startButton.addEventListener('click', startTimer);
        document.addEventListener('fullscreenchange', () => {
            if (!document.fullscreenElement) resetApp();
        });

        // Bloqueios “soft”
        document.addEventListener('dragstart', e => e.preventDefault());
        document.addEventListener('copy', e => e.preventDefault());
        document.addEventListener('cut', e => e.preventDefault());
        document.addEventListener('keydown', e => {
            const k = e.key?.toLowerCase();
            if ((e.ctrlKey || e.metaKey) && ['s', 'p', 'u', 'c', 'i', 'j'].includes(k)) e.preventDefault(); // Ctrl+S,P,U,C,I,J
            if (k === 'f12') e.preventDefault(); // F12
        });

        // Inicialização
        updateDisplay();
        loadBackgroundImages();
    </script>
</body>

</html>